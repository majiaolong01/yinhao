{"version":3,"sources":["service/config.js","container/product/index.jsx"],"names":["axios","defaults","withCredentials","interceptors","request","use","config","access_token","sessionStorage","getItem","headers","common","error","Promise","reject","response","data","code","message","window","location","replace","getPublicKey","get","login","post","getAllProduct","upload","updateProduct","download","responseType","Product","connect","state","user","props","param","$http","then","res","setState","productList","list","goEditProduct","item","history","push","pathname","imgurl","fileName","slice","lastIndexOf","isLoading","blob","Blob","document","createElement","link","style","display","href","URL","createObjectURL","body","appendChild","click","revokeObjectURL","removeChild","navigator","msSaveBlob","page","current","this","Meta","className","gutter","map","index","span","key","bordered","actions","type","onClick","cover","alt","categrory","src","cursor","title","name","description","spinning","Component"],"mappings":"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","file":"static/js/10.786a6ff5.chunk.js","sourcesContent":["import axios from 'axios'\r\nimport {message} from 'antd'\r\naxios.defaults.withCredentials = true;\r\naxios.interceptors.request.use(function(config) {\r\n    const access_token=sessionStorage.getItem('accessToken');\r\n   if(access_token)  config.headers.common[\"access_token\"]=access_token;\r\n    return config;\r\n}, function(error) {\r\n\r\n    return Promise.reject(error);\r\n});\r\naxios.interceptors.response.use(function(config) {\r\n    if(config.data.code===401){\r\n        message.error(config.data.message,2,()=>{window.location.replace(\"/\");});\r\n\r\n    }\r\n    return config.data;\r\n}, function(error) {\r\n    // Do something with response error\r\n    return Promise.reject(error);\r\n});\r\nexport default {\r\n    getPublicKey: () => {\r\n        return axios.get('/api/admin-server/publicKey');\r\n    },\r\n    login:data=>{\r\n        return axios.post('/api/admin-server/login',data);\r\n    },\r\n    getAllProduct:data=>{\r\n        return  axios.post('/api/admin-server/product/allproduct',data)\r\n    },\r\n    upload:data=>{\r\n        return axios.post('/api/admin-server/product/upload',data);\r\n    },\r\n    updateProduct:data=>{\r\n        return axios.post('/api/admin-server/product/update',data);\r\n    },\r\n    download:data=>{\r\n        return axios.post('/api/admin-server/product/download',data,{responseType: 'blob'});\r\n    }\r\n}","import React, {Component} from 'react'\r\nimport $http from \"../../service/config\";\r\nimport {Card, Col, Row,Icon,Spin } from 'antd'\r\nimport './index.scss'\r\nimport {connect} from \"react-redux\";\r\n@connect(\r\n    state=>state.user\r\n)\r\nclass Product extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            param:{\r\n                page:1,\r\n                current:5\r\n            },\r\n            productList:[],\r\n            isLoading:false\r\n\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n       // console.log(this.props)\r\n        const {param}=this.state;\r\n        this.getAllProduct(param);\r\n    }\r\n\r\n    getAllProduct=param=>{\r\n        $http.getAllProduct(param).then(res=>{\r\n            if(res.code===200){\r\n                this.setState({\r\n                    productList:res.data.list\r\n                })\r\n            }\r\n        })\r\n    }\r\n    goEditProduct=item=>{\r\n        const {history}=this.props;\r\n        history.push({pathname:'/productEdit',state:{param:item}})\r\n    }\r\n    download=item=>{\r\n        const {imgurl}=item;\r\n        const fileName=imgurl.slice(imgurl.lastIndexOf('/')+1);\r\n        this.setState({isLoading:true});\r\n        //console.log(fileName)\r\n        $http.download({imgurl}).then(res=>{\r\n            this.setState({isLoading:false});\r\n            const blob = new Blob([res]);\r\n            //对于<a>标签，只有 Firefox 和 Chrome（内核） 支持 download 属性\r\n            //IE10以上支持blob但是依然不支持download\r\n            if ('download' in document.createElement('a')) {\r\n                //支持a标签download的浏览器\r\n                const link = document.createElement('a')//创建a标签\r\n                link.download = fileName//a标签添加属性\r\n                link.style.display = 'none'\r\n                link.href = URL.createObjectURL(blob)\r\n                document.body.appendChild(link)\r\n                link.click()//执行下载\r\n                URL.revokeObjectURL(link.href) //释放url\r\n                document.body.removeChild(link)//释放标签\r\n            }else{\r\n                navigator.msSaveBlob(blob, fileName)\r\n            }\r\n        })\r\n    }\r\n    render() {\r\n        const {productList,isLoading}=this.state;\r\n        const { Meta } = Card;\r\n        return <div className=\"product\">\r\n                <Row gutter={16}>\r\n                    {productList.map((item,index)=>(\r\n                        <Col span={8} key={index}>\r\n                            <Card bordered={false} actions={[\r\n                                <Icon type=\"cloud-download\" onClick={()=>this.download(item)}/>]} cover={<img alt={item.categrory} src={item.imgurl} style={{cursor:\"pointer\"} }  onClick={()=>this.goEditProduct(item)} />} >\r\n                                <Meta  title={item.name} description={item.description} />\r\n                            </Card>\r\n                        </Col>\r\n                    ))}\r\n                </Row>\r\n            <Spin className=\"loading\" spinning={isLoading}/>\r\n        </div>\r\n    }\r\n}\r\n\r\nexport default Product\r\n\r\n  \r\n"],"sourceRoot":""}